{"ast":null,"code":"import _taggedTemplateLiteral from\"/Users/mark.wagner/Dropbox/projects/quic.finance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";import _regeneratorRuntime from\"/Users/mark.wagner/Dropbox/projects/quic.finance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/mark.wagner/Dropbox/projects/quic.finance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/mark.wagner/Dropbox/projects/quic.finance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _defineProperty from\"/Users/mark.wagner/Dropbox/projects/quic.finance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _slicedToArray from\"/Users/mark.wagner/Dropbox/projects/quic.finance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";var _templateObject,_templateObject2,_templateObject3,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8,_templateObject9,_templateObject10,_templateObject11;import BigNumber from'bignumber.js';import React,{useEffect,useState}from'react';import Countdown from'react-countdown';import styled,{keyframes}from'styled-components';import{useWallet}from'use-wallet';import Button from'../../../components/Button';import Card from'../../../components/Card';import CardContent from'../../../components/CardContent';import CardIcon from'../../../components/CardIcon';import Loader from'../../../components/Loader';import Spacer from'../../../components/Spacer';import useAllStakedValue from'../../../hooks/useAllStakedValue';import useFarms from'../../../hooks/useFarms';import useQuic from'../../../hooks/useQuic';import{getEarned,getMasterChefContract}from'../../../quic/utils';import{bnToDec}from'../../../utils';import{Tab,Tabs,TabList,TabPanel}from'react-tabs';import'react-tabs/style/react-tabs.css';import'./tab-styles.css';import{PoolType}from'../../../contexts/Farms/types';var cardsPerRow=3;var FarmCards=function FarmCards(){var _pools;var _useFarms=useFarms(),_useFarms2=_slicedToArray(_useFarms,1),farms=_useFarms2[0];var _useWallet=useWallet(),account=_useWallet.account;var stakedValue=useAllStakedValue();var quicIndex=farms.findIndex(function(_ref){var tokenSymbol=_ref.tokenSymbol;return tokenSymbol==='QUIC';});var quicPrice=quicIndex>=0&&stakedValue[quicIndex]?stakedValue[quicIndex].tokenPriceInWeth:new BigNumber(0);var BLOCKS_PER_YEAR=new BigNumber(2336000);var BAO_BER_BLOCK=new BigNumber(64000);var pools=(_pools={},_defineProperty(_pools,PoolType.UNI,[]),_defineProperty(_pools,PoolType.SUSHI,[]),_defineProperty(_pools,PoolType.ARCHIVED,[]),_pools);farms.forEach(function(farm,i){var farmWithStakedValue=_objectSpread(_objectSpread(_objectSpread({},farm),stakedValue[i]),{},{poolType:farm.poolType||PoolType.UNI,apy:stakedValue[i]?quicPrice.times(BAO_BER_BLOCK).times(BLOCKS_PER_YEAR).times(stakedValue[i].poolWeight).div(stakedValue[i].totalWethValue):null});pools[farmWithStakedValue.poolType].push(farmWithStakedValue);});return/*#__PURE__*/React.createElement(Tabs,null,/*#__PURE__*/React.createElement(TabList,null,/*#__PURE__*/React.createElement(Tab,null,\"Uni Pools\"),/*#__PURE__*/React.createElement(Tab,null,\"Sushi Pools\"),/*#__PURE__*/React.createElement(Tab,null,\"Archived Pools\")),/*#__PURE__*/React.createElement(TabPanel,null,/*#__PURE__*/React.createElement(StyledCards,null,pools[PoolType.UNI].length?pools[PoolType.UNI].map(function(farm,i){return/*#__PURE__*/React.createElement(React.Fragment,{key:i},/*#__PURE__*/React.createElement(FarmCard,{farm:farm}),(i+1)%cardsPerRow!==0&&/*#__PURE__*/React.createElement(StyledSpacer,null));}):/*#__PURE__*/React.createElement(StyledLoadingWrapper,null,/*#__PURE__*/React.createElement(Loader,{text:\"Cooking the rice ...\"})))),/*#__PURE__*/React.createElement(TabPanel,null,/*#__PURE__*/React.createElement(StyledCards,null,pools[PoolType.SUSHI].length?pools[PoolType.SUSHI].map(function(farm,i){return/*#__PURE__*/React.createElement(React.Fragment,{key:i},/*#__PURE__*/React.createElement(FarmCard,{farm:farm}),(i+1)%cardsPerRow!==0&&/*#__PURE__*/React.createElement(StyledSpacer,null));}):/*#__PURE__*/React.createElement(StyledLoadingWrapper,null,/*#__PURE__*/React.createElement(Loader,{text:\"Cooking the rice ...\"})))),/*#__PURE__*/React.createElement(TabPanel,null,/*#__PURE__*/React.createElement(StyledCards,null,pools[PoolType.ARCHIVED].length?pools[PoolType.ARCHIVED].map(function(farm,i){return/*#__PURE__*/React.createElement(React.Fragment,{key:i},/*#__PURE__*/React.createElement(FarmCard,{farm:farm}),(i+1)%cardsPerRow!==0&&/*#__PURE__*/React.createElement(StyledSpacer,null));}):/*#__PURE__*/React.createElement(StyledLoadingWrapper,null,/*#__PURE__*/React.createElement(Loader,{text:\"Cooking the rice ...\"})))));};var FarmCard=function FarmCard(_ref2){var farm=_ref2.farm;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),startTime=_useState2[0],setStartTime=_useState2[1];var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),harvestable=_useState4[0],setHarvestable=_useState4[1];var _useWallet2=useWallet(),account=_useWallet2.account;var lpTokenAddress=farm.lpTokenAddress;var quic=useQuic();var renderer=function renderer(countdownProps){var hours=countdownProps.hours,minutes=countdownProps.minutes,seconds=countdownProps.seconds;var paddedSeconds=seconds<10?\"0\".concat(seconds):seconds;var paddedMinutes=minutes<10?\"0\".concat(minutes):minutes;var paddedHours=hours<10?\"0\".concat(hours):hours;return/*#__PURE__*/React.createElement(\"span\",{style:{width:'100%'}},paddedHours,\":\",paddedMinutes,\":\",paddedSeconds);};useEffect(function(){function fetchEarned(){return _fetchEarned.apply(this,arguments);}function _fetchEarned(){_fetchEarned=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var earned;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!quic){_context.next=2;break;}return _context.abrupt(\"return\");case 2:_context.next=4;return getEarned(getMasterChefContract(quic),lpTokenAddress,account);case 4:earned=_context.sent;setHarvestable(bnToDec(earned));case 6:case\"end\":return _context.stop();}}},_callee);}));return _fetchEarned.apply(this,arguments);}if(quic&&account){fetchEarned();}},[quic,lpTokenAddress,account,setHarvestable]);var poolActive=true;// startTime * 1000 - Date.now() <= 0\nvar tokenBuy='Buy '+farm.tokenSymbol;var destination=farm.refUrl;return/*#__PURE__*/React.createElement(StyledCardWrapper,null,farm.tokenSymbol==='BAO'&&/*#__PURE__*/React.createElement(StyledCardAccent,null),/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardContent,null,/*#__PURE__*/React.createElement(StyledContent,null,/*#__PURE__*/React.createElement(CardIcon,null,/*#__PURE__*/React.createElement(\"img\",{src:farm.icon,alt:\"\",height:\"50\"})),/*#__PURE__*/React.createElement(StyledTitle,null,farm.name),/*#__PURE__*/React.createElement(StyledDetails,null,/*#__PURE__*/React.createElement(StyledDetail,null,\"Deposit \",farm.lpToken.toUpperCase()),/*#__PURE__*/React.createElement(StyledDetail,null,\"Earn \",farm.earnToken.toUpperCase())),/*#__PURE__*/React.createElement(Spacer,null),/*#__PURE__*/React.createElement(Button,{disabled:!poolActive,text:poolActive?'Select':undefined,to:\"/farms/\".concat(farm.id)},!poolActive&&/*#__PURE__*/React.createElement(Countdown,{date:new Date(startTime*1000),renderer:renderer})),/*#__PURE__*/React.createElement(Spacer,null),/*#__PURE__*/React.createElement(Button,{text:tokenBuy,href:destination}),/*#__PURE__*/React.createElement(StyledInsight,null,/*#__PURE__*/React.createElement(\"span\",null,\"APY\"),/*#__PURE__*/React.createElement(\"span\",null,farm.apy?\"\".concat(farm.apy.times(new BigNumber(100)).toNumber().toLocaleString('en-US').slice(0,-1),\"%\"):'Loading ...'))))));};var RainbowLight=keyframes(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  \\n\\t0% {\\n\\t\\tbackground-position: 0% 50%;\\n\\t}\\n\\t50% {\\n\\t\\tbackground-position: 100% 50%;\\n\\t}\\n\\t100% {\\n\\t\\tbackground-position: 0% 50%;\\n\\t}\\n\"])));var StyledCardAccent=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n\\tbackground: linear-gradient(\\n\\t\\t45deg,\\n\\t\\trgba(255, 0, 0, 1) 0%,\\n\\t\\trgba(255, 154, 0, 1) 10%,\\n\\t\\trgba(208, 222, 33, 1) 20%,\\n\\t\\trgba(79, 220, 74, 1) 30%,\\n\\t\\trgba(63, 218, 216, 1) 40%,\\n\\t\\trgba(47, 201, 226, 1) 50%,\\n\\t\\trgba(28, 127, 238, 1) 60%,\\n\\t\\trgba(95, 21, 242, 1) 70%,\\n\\t\\trgba(186, 12, 248, 1) 80%,\\n\\t\\trgba(251, 7, 217, 1) 90%,\\n\\t\\trgba(255, 0, 0, 1) 100%\\n\\t);\\n\\tbackground-size: 300% 300%;\\n\\tanimation: \",\" 2s linear infinite;\\n\\tborder-radius: 12px;\\n\\tfilter: blur(6px);\\n\\tposition: absolute;\\n\\ttop: -2px;\\n\\tright: -2px;\\n\\tbottom: -2px;\\n\\tleft: -2px;\\n\\tz-index: -1;\\n\"])),RainbowLight);var StyledCards=styled.div(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n\\twidth: 900px;\\n\\tdisplay: flex;\\n\\tflex-flow: row wrap;\\n\\tjustify-content: space-evenly;\\n\\t@media (max-width: 768px) {\\n\\t\\twidth: 100%;\\n\\t\\tflex-flow: column nowrap;\\n\\t\\talign-items: center;\\n\\t}\\n\"])));var StyledLoadingWrapper=styled.div(_templateObject4||(_templateObject4=_taggedTemplateLiteral([\"\\n\\talign-items: center;\\n\\tdisplay: flex;\\n\\tflex: 1;\\n\\tjustify-content: center;\\n\"])));var StyledCardWrapper=styled.div(_templateObject5||(_templateObject5=_taggedTemplateLiteral([\"\\n\\tdisplay: flex;\\n\\tmargin-top: \",\"px;\\n\\twidth: calc((900px - \",\"px * 2) / 3);\\n\\tposition: relative;\\n\"])),function(props){return props.theme.spacing[4];},function(props){return props.theme.spacing[4];});var StyledTitle=styled.h4(_templateObject6||(_templateObject6=_taggedTemplateLiteral([\"\\n\\tcolor: \",\";\\n\\tfont-size: 19px;\\n\\tfont-weight: 700;\\n\\tmargin: \",\"px 0 0;\\n\\tpadding: 0;\\n\"])),function(props){return props.theme.color.grey[600];},function(props){return props.theme.spacing[2];});var StyledContent=styled.div(_templateObject7||(_templateObject7=_taggedTemplateLiteral([\"\\n\\talign-items: center;\\n\\tdisplay: flex;\\n\\tflex-direction: column;\\n\"])));var StyledSpacer=styled.div(_templateObject8||(_templateObject8=_taggedTemplateLiteral([\"\\n\\theight: \",\"px;\\n\\twidth: \",\"px;\\n\"])),function(props){return props.theme.spacing[4];},function(props){return props.theme.spacing[4];});var StyledDetails=styled.div(_templateObject9||(_templateObject9=_taggedTemplateLiteral([\"\\n\\tmargin-top: \",\"px;\\n\\ttext-align: center;\\n\"])),function(props){return props.theme.spacing[2];});var StyledDetail=styled.div(_templateObject10||(_templateObject10=_taggedTemplateLiteral([\"\\n\\tcolor: \",\";\\n\"])),function(props){return props.theme.color.grey[500];});var StyledInsight=styled.div(_templateObject11||(_templateObject11=_taggedTemplateLiteral([\"\\n\\tdisplay: flex;\\n\\tjustify-content: space-between;\\n\\tbox-sizing: border-box;\\n\\tborder-radius: 8px;\\n\\tbackground: #fffdfa;\\n\\tcolor: #aa9584;\\n\\twidth: 100%;\\n\\tmargin-top: 12px;\\n\\tline-height: 32px;\\n\\tfont-size: 13px;\\n\\tborder: 1px solid #e6dcd5;\\n\\ttext-align: center;\\n\\tpadding: 0 12px;\\n\"])));export default FarmCards;","map":null,"metadata":{},"sourceType":"module"}