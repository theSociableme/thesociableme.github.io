{"ast":null,"code":"import _regeneratorRuntime from\"/Users/mark.wagner/Dropbox/projects/quic.finance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _slicedToArray from\"/Users/mark.wagner/Dropbox/projects/quic.finance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _asyncToGenerator from\"/Users/mark.wagner/Dropbox/projects/quic.finance/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import BigNumber from'bignumber.js';import{ethers}from'ethers';import{supportedPools}from'./lib/constants';import Web3 from'web3';var web3=new Web3();var BN=web3.utils.BN;BigNumber.config({EXPONENTIAL_AT:1000,DECIMAL_PLACES:80});var GAS_LIMIT={STAKING:{DEFAULT:200000,SNX:850000}};export var getMasterChefAddress=function getMasterChefAddress(quic){return quic&&quic.masterChefAddress;};export var getWethPriceAddress=function getWethPriceAddress(quic){return quic&&quic.wethPriceAddress;};export var getQuicPriceAddress=function getQuicPriceAddress(quic){return quic&&quic.quicPriceAddress;};export var getQuicAddress=function getQuicAddress(quic){return quic&&quic.quicAddress;};export var getWethContract=function getWethContract(quic){return quic&&quic.contracts&&quic.contracts.weth;};export var getWethPriceContract=function getWethPriceContract(quic){return quic&&quic.contracts&&quic.contracts.wethPrice;};export var getQuicPriceContract=function getQuicPriceContract(quic){return quic&&quic.contracts&&quic.contracts.quicPrice;};export var getMasterChefContract=function getMasterChefContract(quic){return quic&&quic.contracts&&quic.contracts.masterChef;};export var getQuicContract=function getQuicContract(quic){return quic&&quic.contracts&&quic.contracts.quic;};export var getFarms=function getFarms(quic){return quic?quic.contracts.pools.map(function(_ref){var pid=_ref.pid,name=_ref.name,symbol=_ref.symbol,icon=_ref.icon,tokenAddress=_ref.tokenAddress,tokenDecimals=_ref.tokenDecimals,tokenSymbol=_ref.tokenSymbol,tokenContract=_ref.tokenContract,lpAddress=_ref.lpAddress,lpContract=_ref.lpContract,refUrl=_ref.refUrl,poolType=_ref.poolType;return{pid:pid,id:symbol,name:name,lpToken:symbol,lpTokenAddress:lpAddress,lpContract:lpContract,tokenAddress:tokenAddress,tokenDecimals:tokenDecimals,tokenSymbol:tokenSymbol,tokenContract:tokenContract,earnToken:'QUIC',earnTokenAddress:quic.contracts.quic.options.address,icon:icon,refUrl:refUrl,poolType:poolType};}):[];};export var getPoolWeight=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(masterChefContract,pid){var _yield$Promise$all,_yield$Promise$all2,allocPoint,totalAllocPoint;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Promise.all([masterChefContract.methods.poolInfo(pid).call(),masterChefContract.methods.totalAllocPoint().call()]);case 2:_yield$Promise$all=_context.sent;_yield$Promise$all2=_slicedToArray(_yield$Promise$all,2);allocPoint=_yield$Promise$all2[0].allocPoint;totalAllocPoint=_yield$Promise$all2[1];return _context.abrupt(\"return\",new BigNumber(allocPoint).div(new BigNumber(totalAllocPoint)));case 7:case\"end\":return _context.stop();}}},_callee);}));return function getPoolWeight(_x,_x2){return _ref2.apply(this,arguments);};}();export var getEarned=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(masterChefContract,pid,account){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",masterChefContract.methods.pendingReward(pid,account).call());case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function getEarned(_x3,_x4,_x5){return _ref3.apply(this,arguments);};}();export var getLockedEarned=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(quicContract,account){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:return _context3.abrupt(\"return\",quicContract.methods.lockOf(account).call());case 1:case\"end\":return _context3.stop();}}},_callee3);}));return function getLockedEarned(_x6,_x7){return _ref4.apply(this,arguments);};}();export var getTotalLPWethValue=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(masterChefContract,wethContract,lpContract,tokenContract,tokenDecimals,pid){var _yield$Promise$all3,_yield$Promise$all4,tokenAmountWholeLP,balance,totalSupply,lpContractWeth,poolWeight,portionLp,lpWethWorth,totalLpWethValue,tokenAmount,wethAmount;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return Promise.all([tokenContract.methods.balanceOf(lpContract.options.address).call(),lpContract.methods.balanceOf(masterChefContract.options.address).call(),lpContract.methods.totalSupply().call(),wethContract.methods.balanceOf(lpContract.options.address).call(),getPoolWeight(masterChefContract,pid)]);case 2:_yield$Promise$all3=_context4.sent;_yield$Promise$all4=_slicedToArray(_yield$Promise$all3,5);tokenAmountWholeLP=_yield$Promise$all4[0];balance=_yield$Promise$all4[1];totalSupply=_yield$Promise$all4[2];lpContractWeth=_yield$Promise$all4[3];poolWeight=_yield$Promise$all4[4];// Return p1 * w1 * 2\nportionLp=new BigNumber(balance).div(new BigNumber(totalSupply));lpWethWorth=new BigNumber(lpContractWeth);totalLpWethValue=portionLp.times(lpWethWorth).times(new BigNumber(2));// Calculate\ntokenAmount=new BigNumber(tokenAmountWholeLP).times(portionLp).div(new BigNumber(10).pow(tokenDecimals));wethAmount=new BigNumber(lpContractWeth).times(portionLp).div(new BigNumber(10).pow(18));return _context4.abrupt(\"return\",{tokenAmount:tokenAmount,wethAmount:wethAmount,totalWethValue:totalLpWethValue.div(new BigNumber(10).pow(18)),tokenPriceInWeth:wethAmount.div(tokenAmount),poolWeight:poolWeight});case 15:case\"end\":return _context4.stop();}}},_callee4);}));return function getTotalLPWethValue(_x8,_x9,_x10,_x11,_x12,_x13){return _ref5.apply(this,arguments);};}();export var approve=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(lpContract,masterChefContract,account){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:return _context5.abrupt(\"return\",lpContract.methods.approve(masterChefContract.options.address,ethers.constants.MaxUint256).send({from:account}));case 1:case\"end\":return _context5.stop();}}},_callee5);}));return function approve(_x14,_x15,_x16){return _ref6.apply(this,arguments);};}();export var stake=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(masterChefContract,pid,amount,account,ref){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:return _context6.abrupt(\"return\",masterChefContract.methods.deposit(pid,ethers.utils.parseUnits(amount,18),ref).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;}));case 1:case\"end\":return _context6.stop();}}},_callee6);}));return function stake(_x17,_x18,_x19,_x20,_x21){return _ref7.apply(this,arguments);};}();export var unstake=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(masterChefContract,pid,amount,account,ref){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:return _context7.abrupt(\"return\",masterChefContract.methods.withdraw(pid,ethers.utils.parseUnits(amount,18),ref).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;}));case 1:case\"end\":return _context7.stop();}}},_callee7);}));return function unstake(_x22,_x23,_x24,_x25,_x26){return _ref8.apply(this,arguments);};}();export var harvest=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(masterChefContract,pid,account){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:return _context8.abrupt(\"return\",masterChefContract.methods.claimReward(pid).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;}));case 1:case\"end\":return _context8.stop();}}},_callee8);}));return function harvest(_x27,_x28,_x29){return _ref9.apply(this,arguments);};}();export var getStaked=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(masterChefContract,pid,account){var _yield$masterChefCont,amount;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.prev=0;_context9.next=3;return masterChefContract.methods.userInfo(pid,account).call();case 3:_yield$masterChefCont=_context9.sent;amount=_yield$masterChefCont.amount;return _context9.abrupt(\"return\",new BigNumber(amount));case 8:_context9.prev=8;_context9.t0=_context9[\"catch\"](0);return _context9.abrupt(\"return\",new BigNumber(0));case 11:case\"end\":return _context9.stop();}}},_callee9,null,[[0,8]]);}));return function getStaked(_x30,_x31,_x32){return _ref10.apply(this,arguments);};}();export var getWethPrice=/*#__PURE__*/function(){var _ref11=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(quic){var amount;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:console.log(quic);_context10.next=3;return quic.contracts.wethPrice.methods.latestAnswer().call();case 3:amount=_context10.sent;return _context10.abrupt(\"return\",new BigNumber(amount));case 5:case\"end\":return _context10.stop();}}},_callee10);}));return function getWethPrice(_x33){return _ref11.apply(this,arguments);};}();export var getQuicPrice=/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(quic){var addr,amount;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:addr='0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2';_context11.next=3;return quic.contracts.quicPrice.methods.consult(addr.toString(),1).call();case 3:amount=_context11.sent;return _context11.abrupt(\"return\",new BigNumber(amount));case 5:case\"end\":return _context11.stop();}}},_callee11);}));return function getQuicPrice(_x34){return _ref12.apply(this,arguments);};}();export var getQuicSupply=/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(quic){return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.t0=BigNumber;_context12.next=3;return quic.contracts.quic.methods.totalSupply().call();case 3:_context12.t1=_context12.sent;return _context12.abrupt(\"return\",new _context12.t0(_context12.t1));case 5:case\"end\":return _context12.stop();}}},_callee12);}));return function getQuicSupply(_x35){return _ref13.apply(this,arguments);};}();export var getReferrals=/*#__PURE__*/function(){var _ref14=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(masterChefContract,account){return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:_context13.next=2;return masterChefContract.methods.getGlobalRefAmount(account).call();case 2:return _context13.abrupt(\"return\",_context13.sent);case 3:case\"end\":return _context13.stop();}}},_callee13);}));return function getReferrals(_x36,_x37){return _ref14.apply(this,arguments);};}();export function getRefUrl(){var refer='0x0000000000000000000000000000000000000000';var urlParams=new URLSearchParams(window.location.search);if(urlParams.has('ref')){refer=urlParams.get('ref');}console.log(refer);return refer;}export var redeem=/*#__PURE__*/function(){var _ref15=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee14(masterChefContract,account){var now;return _regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:now=new Date().getTime()/1000;if(!(now>=1597172400)){_context14.next=5;break;}return _context14.abrupt(\"return\",masterChefContract.methods.exit().send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;}));case 5:alert('pool not active');case 6:case\"end\":return _context14.stop();}}},_callee14);}));return function redeem(_x38,_x39){return _ref15.apply(this,arguments);};}();export var runSetup=/*#__PURE__*/function(){var _ref16=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee15(masterChefContract,account){return _regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:_context15.next=2;return masterChefContract.methods.setup().send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;});case 2:return _context15.abrupt(\"return\",_context15.sent);case 3:case\"end\":return _context15.stop();}}},_callee15);}));return function runSetup(_x40,_x41){return _ref16.apply(this,arguments);};}();export var addPair=/*#__PURE__*/function(){var _ref17=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee16(masterChefContract,account,weight,lpAddress){return _regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:_context16.next=2;return masterChefContract.methods.add(weight,lpAddress,false).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;});case 2:return _context16.abrupt(\"return\",_context16.sent);case 3:case\"end\":return _context16.stop();}}},_callee16);}));return function addPair(_x42,_x43,_x44,_x45){return _ref17.apply(this,arguments);};}();export var addAuthorized=/*#__PURE__*/function(){var _ref18=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee17(masterChefContract,quic,account,authorizedAddress){return _regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:_context17.next=2;return quic.methods.addAuthorized(authorizedAddress).send({from:account}).on('transactionHash',function(tx){console.log(tx);});case 2:_context17.next=4;return masterChefContract.methods.addAuthorized(authorizedAddress).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;});case 4:return _context17.abrupt(\"return\",_context17.sent);case 5:case\"end\":return _context17.stop();}}},_callee17);}));return function addAuthorized(_x46,_x47,_x48,_x49){return _ref18.apply(this,arguments);};}();export var transferOwnership=/*#__PURE__*/function(){var _ref19=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee18(quic,account,recipient){return _regeneratorRuntime.wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:_context18.next=2;return quic.methods.transferOwnership(recipient).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;});case 2:return _context18.abrupt(\"return\",_context18.sent);case 3:case\"end\":return _context18.stop();}}},_callee18);}));return function transferOwnership(_x50,_x51,_x52){return _ref19.apply(this,arguments);};}();export var mint=/*#__PURE__*/function(){var _ref20=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee19(quic,account,recipient,amount){return _regeneratorRuntime.wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:_context19.next=2;return quic.methods.mint(recipient,amount).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;});case 2:return _context19.abrupt(\"return\",_context19.sent);case 3:case\"end\":return _context19.stop();}}},_callee19);}));return function mint(_x53,_x54,_x55,_x56){return _ref20.apply(this,arguments);};}();export var capUpdate=/*#__PURE__*/function(){var _ref21=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee20(quic,account,amount){return _regeneratorRuntime.wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:_context20.next=2;return quic.methods.capUpdate(amount).send({from:account}).on('transactionHash',function(tx){console.log(tx);return tx.transactionHash;});case 2:return _context20.abrupt(\"return\",_context20.sent);case 3:case\"end\":return _context20.stop();}}},_callee20);}));return function capUpdate(_x57,_x58,_x59){return _ref21.apply(this,arguments);};}();export var getCap=/*#__PURE__*/function(){var _ref22=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee21(quic){return _regeneratorRuntime.wrap(function _callee21$(_context21){while(1){switch(_context21.prev=_context21.next){case 0:_context21.t0=BigNumber;_context21.next=3;return quic.contracts.quic.methods.cap().call();case 3:_context21.t1=_context21.sent;return _context21.abrupt(\"return\",new _context21.t0(_context21.t1));case 5:case\"end\":return _context21.stop();}}},_callee21);}));return function getCap(_x60){return _ref22.apply(this,arguments);};}();","map":null,"metadata":{},"sourceType":"module"}